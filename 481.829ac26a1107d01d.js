"use strict";(self.webpackChunkpolk=self.webpackChunkpolk||[]).push([[481],{481:(G,u,s)=>{s.r(u),s.d(u,{EntityDetailApiService:()=>d,EntityDetailComponent:()=>g,EntityDetailModule:()=>T});var m=s(2494),f=s(1207),t=s(4438);class d{}var h=s(466);const y=(()=>{class n extends m.LI{constructor(e,i,o){super({formV1Options:null,info:null}),this.api=e,this.router=i;{const c=o.snapshot.paramMap.get("schemaId"),a=o.snapshot.paramMap.get("itemId"),l=c?{schemaId:c,itemId:a}:null,p=l?{schema:{type:"load-by-id",id:c,item:a?{type:"load-by-id",id:a}:null},saveCb:this.createSaveCb(l),can:[m.JI.entitiesItemEdit]}:null;this.setState({formV1Options:p,info:l})}}createSaveCb(e){return i=>{const{type:o,controller:c}=i;if("fail"===o)return f.gz.obj.error(i.error||"Failed to save an item"),void c.setSaving(!1);"success"===o&&this.api.save({data:i.data,info:e,cb:a=>{if("fail"!==a.type)return"success"===a.type?(f.gz.obj.success("Saved successfully"),void this.router.navigate(["/app/entities/items"])):void 0;f.gz.obj.error(a.error||"Failed to save an item")}})}}static#t=this.\u0275fac=function(i){return new(i||n)(t.KVO(d),t.KVO(h.Ix),t.KVO(h.nX))};static#n=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac})}return n})();var v=s(177),I=s(4874);function D(n,r){if(1&n&&(t.qex(0),t.j41(1,"h2"),t.EFF(2),t.k0s(),t.bVm()),2&n){const e=r.ngIf;t.R7$(2),t.Lme("[",e.schemaId,"]: ",e.itemId?"Edit":"Add"," item")}}function E(n,r){1&n&&t.nrm(0,"form-v1",3),2&n&&t.Y8G("options",r.ngIf)}function C(n,r){if(1&n&&(t.qex(0),t.DNE(1,D,3,2,"ng-container",0),t.j41(2,"div",1),t.DNE(3,E,1,1,"form-v1",2),t.k0s(),t.bVm()),2&n){const e=r.ngIf;t.R7$(),t.Y8G("ngIf",e.info),t.R7$(2),t.Y8G("ngIf",e.formV1Options)}}let g=(()=>{class n{constructor(e){this.state$=e.state$}static#t=this.\u0275fac=function(i){return new(i||n)(t.rXU(y))};static#n=this.\u0275cmp=t.VBU({type:n,selectors:[["ng-component"]],features:[t.Jv_([y])],decls:2,vars:3,consts:[[4,"ngIf"],[1,"detail-formV1-wrapper"],[3,"options",4,"ngIf"],[3,"options"]],template:function(i,o){1&i&&(t.DNE(0,C,4,2,"ng-container",0),t.nI1(1,"async")),2&i&&t.Y8G("ngIf",t.bMT(1,1,o.state$))},dependencies:[v.bT,I.V,v.Jj],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1 0}[_nghost-%COMP%]   .detail-formV1-wrapper[_ngcontent-%COMP%]{padding-top:12px;max-width:100%}"],changeDetection:0})}return n})();var V=s(6333),O=s(6354),M=s(9437),j=s(983),F=s(6697);let S=(()=>{class n{constructor(e){this.api=e}save(e){const{data:i,info:o,cb:c}=e;if(!i||!o||!o.schemaId)return void c({type:"fail",error:"Invalid data"});const{itemId:a,schemaId:l}=o,p={...i,schemaId:l};(a?this.api.setDoc(p,"items",a):this.api.addDoc(p,"items")).pipe((0,O.T)(()=>{c({type:"success"})}),(0,M.W)(b=>(c({type:"fail",error:(0,m.As)(b)}),j.w)),(0,F.s)(1)).subscribe()}static#t=this.\u0275fac=function(i){return new(i||n)(t.KVO(f.p1))};static#n=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac})}return n})();const $=[h.iI.forChild([{path:"",component:g}])],x=[V.QY];let T=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#n=this.\u0275mod=t.$C({type:n});static#e=this.\u0275inj=t.G2t({providers:[{provide:d,useClass:S}],imports:[v.MD,$,x]})}return n})()}}]);