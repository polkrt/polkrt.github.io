"use strict";(self.webpackChunkpolk=self.webpackChunkpolk||[]).push([[263],{1263:(M,p,s)=>{s.r(p),s.d(p,{EntitiesSchemaComponent:()=>$,EntitiesSchemaModule:()=>L,SchemaItemsApiService:()=>m});var l=s(177),f=s(466),o=s(2494),a=s(1207),u=s(9437),g=s(7673),E=s(6697),I=s(6354),t=s(4438);class m{}const v=(()=>{class e extends o.LI{constructor(n,i){super({items:[],can:(0,o.$3)([]),loading:!1}),this.api=n,this.subscriptions=new o.AT,this.loadSchemas(),(0,o.H9)(i,this.subscriptions,c=>{this.setState({can:(0,o.$3)(c)})})}loadSchemas(){const n=this.api.getSchemas$().pipe((0,u.W)(i=>(a.gz.obj.error((0,o.As)(i)),(0,g.of)([]))));this.setState({loading:!0}),(0,o.H3)({key:"schemasSub",subscriptions:this.subscriptions,source$:n,cb:i=>{this.setState({items:i.map(c=>c.id),loading:!1})}})}deleteItem(n){confirm(`Delete schema ${n}?`)&&this.api.deleteSchema$(n).pipe((0,E.s)(1),(0,u.W)(i=>(a.gz.obj.error((0,o.As)(i)),(0,g.of)(!1))),(0,I.T)(i=>{i&&(a.gz.obj.success("Deleted successfully"),this.loadSchemas())})).subscribe()}ngOnDestroy(){this.subscriptions.removeAllSubscriptions()}static#t=this.\u0275fac=function(i){return new(i||e)(t.KVO(m),t.KVO(a.Nr))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac})}return e})();var b=s(6003),S=s(9183),d=s(8834),h=s(105);const y=()=>["editor"],F=e=>["editor",e];function j(e,r){1&e&&(t.j41(0,"div",6),t.nrm(1,"mat-spinner",7),t.k0s()),2&e&&(t.R7$(),t.Y8G("diameter",100))}function D(e,r){1&e&&(t.j41(0,"div")(1,"p"),t.EFF(2,"No schemas"),t.k0s()())}function G(e,r){if(1&e){const n=t.RV6();t.j41(0,"mat-list-option",8)(1,"div",9)(2,"span"),t.EFF(3),t.k0s(),t.j41(4,"button",10),t.bIt("click",function(c){const O=t.eBV(n).$implicit,N=t.XpG(2);return c.stopPropagation(),t.Njj(N.deleteItem(O))}),t.EFF(5," Delete "),t.k0s()()()}if(2&e){const n=r.$implicit,i=t.XpG().ngIf;t.Y8G("routerLink",t.eq3(4,F,n))("disable-control-condition",!i.can["entities:schema:view"]),t.R7$(3),t.JRh(n),t.R7$(),t.Y8G("disable-control-condition",!i.can["entities:schema:edit"])}}function C(e,r){if(1&e&&(t.qex(0),t.DNE(1,j,2,1,"div",1),t.j41(2,"div",2)(3,"a",3),t.EFF(4,"Add"),t.k0s()(),t.DNE(5,D,3,0,"div",0),t.j41(6,"mat-selection-list",4),t.DNE(7,G,6,6,"mat-list-option",5),t.k0s(),t.bVm()),2&e){const n=r.ngIf;t.R7$(),t.Y8G("ngIf",n.loading),t.R7$(),t.Y8G("disable-control-condition",!n.can["entities:schema:edit"]),t.R7$(),t.Y8G("routerLink",t.lJ4(7,y)),t.R7$(2),t.Y8G("ngIf",!n.loading&&0===n.items.length),t.R7$(),t.Y8G("multiple",!1)("hideSingleSelectionIndicator",!0),t.R7$(),t.Y8G("ngForOf",n.items)}}let $=(()=>{class e{constructor(n){this.facade=n,this.state$=n.state$}deleteItem(n){this.facade.deleteItem(n)}static#t=this.\u0275fac=function(i){return new(i||e)(t.rXU(v))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["ng-component"]],features:[t.Jv_([v])],decls:2,vars:3,consts:[[4,"ngIf"],["class","loader-v1",4,"ngIf"],[2,"padding","12px 0",3,"disable-control-condition"],["type","button","mat-flat-button","","color","accent",3,"routerLink"],[3,"multiple","hideSingleSelectionIndicator"],[3,"routerLink","disable-control-condition",4,"ngFor","ngForOf"],[1,"loader-v1"],["color","accent",3,"diameter"],[3,"routerLink","disable-control-condition"],[2,"display","flex","align-items","center","justify-content","space-between","gap","16px"],["type","button","mat-button","","color","warn",3,"click","disable-control-condition"]],template:function(i,c){1&i&&(t.DNE(0,C,8,8,"ng-container",0),t.nI1(1,"async")),2&i&&t.Y8G("ngIf",t.bMT(1,1,c.state$))},dependencies:[l.Sq,l.bT,f.Wk,b.i,S.LG,d.It,d.$z,h.p6,h.oh,l.Jj],styles:["[_nghost-%COMP%]{flex:1 0;display:flex;flex-direction:column;position:relative}"],changeDetection:0})}return e})();var R=s(1801),T=s(963);let x=(()=>{class e{constructor(n){this.api=n}getSchemas$(){return this.api.getDocs("schemas")}deleteSchema$(n){return this.api.deleteDoc("schemas",n)}static#t=this.\u0275fac=function(i){return new(i||e)(t.KVO(a.p1))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac})}return e})();const Y=[f.iI.forChild([{path:"",component:$}])],k=[T.z,S.D6],A=[d.Hl,R.m_,h.Fg];let L=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.$C({type:e});static#n=this.\u0275inj=t.G2t({providers:[{provide:m,useClass:x}],imports:[l.MD,Y,k,A]})}return e})()}}]);